{"version":3,"file":"jsforce-api-analytics.min.js","sources":["jsforce-api-analytics.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","jsforce","modules","api","Analytics","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"_","ReportInstance","report","id","_report","_conn","prototype","retrieve","callback","conn","url","_baseUrl","join","request","thenCall","Report","describe","run","exec","execute","options","isFunction","details","params","method","metadata","headers","Content-Type","body","JSON","stringify","executeAsync","instance","instances","reports"],"mappings":"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","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g=(g.jsforce||(g.jsforce = {}));g=(g.modules||(g.modules = {}));g=(g.api||(g.api = {}));g.Analytics = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/**\r\n * @file Manages Salesforce Analytics API\r\n * @author Shinichi Tomita <shinichi.tomita@gmail.com>\r\n */\r\n\r\n'use strict';\r\n\r\nvar _        = jsforce.require('underscore'),\r\n    Promise  = jsforce.require('./promise');\r\n\r\n/**\r\n * Report instance to retrieving asynchronously executed result\r\n *\r\n * @protected\r\n * @class Analytics~ReportInstance\r\n * @param {Analytics~Report} report - Report\r\n * @param {String} id - Report instance id\r\n */\r\nvar ReportInstance = function(report, id) {\r\n  this._report = report;\r\n  this._conn = report._conn;\r\n  this.id = id;\r\n};\r\n\r\n/**\r\n * Retrieve report result asynchronously executed\r\n *\r\n * @method Analytics~ReportInstance#retrieve\r\n * @param {Callback.<Analytics~ReportResult>} [callback] - Callback function\r\n * @returns {Promise.<Analytics~ReportResult>}\r\n */\r\nReportInstance.prototype.retrieve = function(callback) {\r\n  var conn = this._conn,\r\n      report = this._report;\r\n  var url = [ conn._baseUrl(), \"analytics\", \"reports\", report.id, \"instances\", this.id ].join('/');\r\n  return conn.request(url).thenCall(callback);\r\n};\r\n\r\n/**\r\n * Report object in Analytics API\r\n *\r\n * @protected\r\n * @class Analytics~Report\r\n * @param {Connection} conn Connection\r\n */\r\nvar Report = function(conn, id) {\r\n  this._conn = conn;\r\n  this.id = id;\r\n};\r\n\r\n/**\r\n * Describe report metadata\r\n *\r\n * @method Analytics~Report#describe\r\n * @param {Callback.<Analytics~ReportMetadata>} [callback] - Callback function\r\n * @returns {Promise.<Analytics~ReportMetadata>}\r\n */\r\nReport.prototype.describe = function(callback) {\r\n  var url = [ this._conn._baseUrl(), \"analytics\", \"reports\", this.id, \"describe\" ].join('/');\r\n  return this._conn.request(url).thenCall(callback);\r\n};\r\n\r\n/**\r\n * Run report synchronously\r\n *\r\n * @method Analytics~Report#execute\r\n * @param {Object} [options] - Options\r\n * @param {Boolean} options.details - Flag if include detail in result\r\n * @param {Analytics~ReportMetadata} options.metadata - Overriding report metadata\r\n * @param {Callback.<Analytics~ReportResult>} [callback] - Callback function\r\n * @returns {Promise.<Analytics~ReportResult>}\r\n */\r\nReport.prototype.run = \r\nReport.prototype.exec = \r\nReport.prototype.execute = function(options, callback) {\r\n  options = options || {};\r\n  if (_.isFunction(options)) {\r\n    callback = options;\r\n    options = {};\r\n  }\r\n  var url = [ this._conn._baseUrl(), \"analytics\", \"reports\", this.id ].join('/');\r\n  if (options.details) {\r\n    url += \"?includeDetails=true\";\r\n  }\r\n  var params = { method : options.metadata ? 'POST' : 'GET', url : url };\r\n  if (options.metadata) {\r\n    params.headers = { \"Content-Type\" : \"application/json\" };\r\n    params.body = JSON.stringify(options.metadata);\r\n  }\r\n  return this._conn.request(params).thenCall(callback);\r\n};\r\n\r\n/**\r\n * Run report asynchronously\r\n *\r\n * @method Analytics~Report#executeAsync\r\n * @param {Object} [options] - Options\r\n * @param {Boolean} options.details - Flag if include detail in result\r\n * @param {Analytics~ReportMetadata} options.metadata - Overriding report metadata\r\n * @param {Callback.<Analytics~ReportInstanceAttrs>} [callback] - Callback function\r\n * @returns {Promise.<Analytics~ReportInstanceAttrs>}\r\n */\r\nReport.prototype.executeAsync = function(options, callback) {\r\n  options = options || {};\r\n  if (_.isFunction(options)) {\r\n    callback = options;\r\n    options = {};\r\n  }\r\n  var url = [ this._conn._baseUrl(), \"analytics\", \"reports\", this.id, \"instances\" ].join('/');\r\n  if (options.details) {\r\n    url += \"?includeDetails=true\";\r\n  }\r\n  var params = { method : 'POST', url : url, body: \"\" };\r\n  if (options.metadata) {\r\n    params.headers = { \"Content-Type\" : \"application/json\" };\r\n    params.body = JSON.stringify(options.metadata);\r\n  }\r\n  return this._conn.request(params).thenCall(callback);\r\n};\r\n\r\n/**\r\n * Get report instance for specified instance ID\r\n *\r\n * @method Analytics~Report#instance\r\n * @param {String} id - Report instance ID\r\n * @returns {Analytics~ReportInstance}\r\n */\r\nReport.prototype.instance = function(id) {\r\n  return new ReportInstance(this, id);\r\n};\r\n\r\n/**\r\n * List report instances which had been executed asynchronously\r\n *\r\n * @method Analytics~Report#instances\r\n * @param {Callback.<Array.<Analytics~ReportInstanceAttrs>>} [callback] - Callback function\r\n * @returns {Promise.<Array.<Analytics~ReportInstanceAttrs>>}\r\n */\r\nReport.prototype.instances = function(callback) {\r\n  var url = [ this._conn._baseUrl(), \"analytics\", \"reports\", this.id, \"instances\" ].join('/');\r\n  return this._conn.request(url).thenCall(callback);\r\n};\r\n\r\n\r\n/**\r\n * API class for Analytics API\r\n *\r\n * @class\r\n * @param {Connection} conn Connection\r\n */\r\nvar Analytics = function(conn) {\r\n  this._conn = conn;\r\n};\r\n\r\n/**\r\n * Get report object of Analytics API\r\n *\r\n * @param {String} id - Report Id\r\n * @returns {Analytics~Report}\r\n */\r\nAnalytics.prototype.report = function(id) {\r\n  return new Report(this._conn, id);\r\n};\r\n\r\n/**\r\n * Get recent report list\r\n *\r\n * @param {Callback.<Array.<Analytics~ReportInfo>>} [callback] - Callback function\r\n * @returns {Promise.<Array.<Analytics~ReportInfo>>}\r\n */\r\nAnalytics.prototype.reports = function(callback) {\r\n  var url = [ this._conn._baseUrl(), \"analytics\", \"reports\" ].join('/');\r\n  return this._conn.request(url).thenCall(callback);\r\n};\r\n\r\nmodule.exports = Analytics;\r\n\n},{}]},{},[1])(1)\n});"]}